import{_ as l,a as d,b as h,c}from"./od_share_add-BTUU5x0P.js";import{_ as p,j as u,f as t,m as n,a,e as o,w as m,l as r,o as g}from"./app-Bl4GcpgC.js";const f={},b={class:"hint-container tip"};function k(v,e){const s=r("RouteLink"),i=r("Mermaid");return g(),u("div",null,[e[3]||(e[3]=t("h1",{id:"onedrive-share",tabindex:"-1"},[t("a",{class:"header-anchor",href:"#onedrive-share"},[t("span",null,"OneDrive / Share")])],-1)),e[4]||(e[4]=t("br",null,null,-1)),e[5]||(e[5]=t("h2",{id:"onedrive-mount",tabindex:"-1"},[t("a",{class:"header-anchor",href:"#onedrive-mount"},[t("span",null,[t("strong",null,"OneDrive mount")])])],-1)),t("div",b,[e[2]||(e[2]=t("p",{class:"hint-container-title"},"Tips",-1)),t("p",null,[e[1]||(e[1]=o("If your account does not support the API, (for example, the school account has not verified the administrator, or the administrator has disabled the API), then you can also mount it through webdav. For details, see ")),a(s,{to:"/guide/drivers/webdav.html"},{default:m(()=>e[0]||(e[0]=[o("webdav")])),_:1,__:[0]})])]),e[6]||(e[6]=n('<p>First open <a href="https://alist.example.com/tool/onedrive/request" target="_blank" rel="noopener noreferrer">https://alist.example.com/tool/onedrive/request</a></p><h3 id="create-an-application" tabindex="-1"><a class="header-anchor" href="#create-an-application"><span><strong>Create an application</strong></span></a></h3><blockquote><p>You can also choose to skip this step and use the client provided by default, but requires the approval of the organization administrator.</p></blockquote><ul><li>On the page that opens, select the region and click Create Application</li><li>After logging in, select <code>Register Application</code>, enter <code>Name</code>, and select <code>Accounts and Individuals in Any Organization Directory</code> (note that you don&#39;t look at the location selection but the text here. Some people may be the middle option, don&#39;t select a single Tenant or other options, otherwise it will cause problems when logging in), enter the redirect URL as <a href="https://alist.example.com/tool/onedrive/callback" target="_blank" rel="noopener noreferrer">https://alist.example.com/tool/onedrive/callback</a>, <code>register</code>, and then you can get client_id<br><img src="'+l+'" alt="client_id" loading="lazy"></li><li>After registering the application, select <code>Certificate and Password</code>, click <code>New Client Password</code>, enter a string of passwords, select the one with the longest time, and click <code>Add</code><br> (Note: The password entered after adding will disappear, please record the value of client_secret)<br><img src="'+d+'" alt="client_secret" loading="lazy"></li><li>Select <code>API Permissions</code>, click <code>MicroSoft Graph</code>, enter file in the <code>Select Permissions</code>, and check <code>Files.read</code> (Note: Files.read is a read-only minimum permission. The permission in the figure is larger, and the same can be done ), click <code>Update Permission</code><br><img src="'+h+'" alt="api" loading="lazy"></li></ul><h3 id="get-refresh-token" tabindex="-1"><a class="header-anchor" href="#get-refresh-token"><span><strong>Get refresh token</strong></span></a></h3><p>Fill in the client_id and client_secret obtained in the previous step into the <a href="https://alist.example.com/tool/onedrive/request" target="_blank" rel="noopener noreferrer">https://alist.example.com/tool/onedrive/request</a> page, click Get Refresh Token, you can get the refresh token</p><h3 id="get-sharepoint-site-id" tabindex="-1"><a class="header-anchor" href="#get-sharepoint-site-id"><span><strong>Get Sharepoint site_id</strong></span></a></h3><p>If you need to mount Sharepoint, after completing the previous step, an input site address will appear on the interface that displays the refresh token. After entering the site address, click Get site_id.</p><h3 id="add-storage" tabindex="-1"><a class="header-anchor" href="#add-storage"><span><strong>Add storage</strong></span></a></h3><p>Fill in the values ​​obtained in the above process one by one.</p><h3 id="root-folder-path" tabindex="-1"><a class="header-anchor" href="#root-folder-path"><span><strong>Root folder path</strong></span></a></h3><p>The default is <code>/</code>, if you need to customize, just fill in the path, starting from the root path, the same as the local path, such as <code>/test</code></p><h4 id="the-default-download-method-used" tabindex="-1"><a class="header-anchor" href="#the-default-download-method-used"><span><strong>The default download method used</strong></span></a></h4>',13)),a(i,{id:"mermaid-72",code:"eJydkE1vwjAMhu/8CguutKztAC3SNmniuNO0aYeKQz6cJSJtuiSlVOLHr7QFscMkNF8S2+/zynYURZOgg0ECn0pzBcI2pbFUQIFBWQHaQ+1RAGtBoKS1Cc+TEySNbbiiLsD7ywS68KE1CDQBqY0hM8bk3Adnd0hmcrUa/1GjRVAkrQ5zbo11XU/KazwdcSnXy/Xy4pBl2W+H++owYDX7crRSoAUmkMO2r9Kkf7AUY5pnd+mWEOJtgdxQ7x+7OI4LHWmadzs6wO9aVwWWYXDphRuUcKHOwz2sBkGSG8upgcrZQ7uNYmoCupIGvcc4evrDliX55nzkHoSPt9dbYW40352uPI3jhXCd1vkFt0Vhy1iFwswaZILuo8p2wnZ6xbB/MPxm5gdtZr9x"}),e[7]||(e[7]=n('<br><h2 id="onedrive-share-url" tabindex="-1"><a class="header-anchor" href="#onedrive-share-url"><span><strong>Onedrive Share Url</strong></span></a></h2><p><img src="'+c+'" alt="api" loading="lazy"></p><br><h3 id="url" tabindex="-1"><a class="header-anchor" href="#url"><span><strong>Url</strong></span></a></h3><p>The sharing link is the same as the example below and can be mounted. It can be obtained from E3, E5, A1, and A1P.</p><div class="language-html line-numbers-mode" data-highlighter="shiki" data-ext="html" data-title="html" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">https://connecthkuhk-my.sharepoint.com/:f:/g/personal/jhyang13_connect_hku_hk/EsEgHtGOWbJImxop6tF15FIBIH-ihrjuDclbrbmwWfY_RA?e=s6fitN</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>If it is OneDrive personal version, it will not work. The link is as follows</p><div class="language-html line-numbers-mode" data-highlighter="shiki" data-ext="html" data-title="html" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">https://onedrive.live.com/?cid=64EA5FCC7735E8C6&amp;id=64EA5FCC7735E8C6%2117289</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><br><h3 id="password" tabindex="-1"><a class="header-anchor" href="#password"><span><strong>Password</strong></span></a></h3><p>It is the extraction code. If you have it, write it. If you don’t have it, don’t fill it in.</p><br><h4 id="the-default-download-method-used-1" tabindex="-1"><a class="header-anchor" href="#the-default-download-method-used-1"><span><strong>The default download method used</strong></span></a></h4>',14)),a(i,{id:"mermaid-103",code:"eJyNkL1uwjAURnee4gpWHBQooFpKK1WMnapWHaIMjn1dWzhxajskefuaNCA6VMKL/75z7HsJIbOgg0EKn0pzBcJ2tbFMQIVBWQHaQ+tRQDmAQMlaE55nZ0ga23HFXID3lxnE4cNgEHgKUhtDF2Uplz44e0S6kLvdtCadFkHRddMvuTXWxTspb3C2nnAp99v99mrYbDZ/DQ9N/4u15ZdjjQItMIUcivGUp+OEtZi2ubGcGWic7YeCUupthdww77NsqirLsie2zmOtDvC71U2FdZhs5+ABJVypyycfd2OgTPPDpW3jE/Dx9lqQhJmArmZBnzAh/9s1P0YFzJNkJVzMOr/itqpsnahQmUWHpWAn0tgYHOY3TOz1ncwPx9ee1g=="})])}const A=p(f,[["render",k]]),x=JSON.parse('{"path":"/guide/drivers/onedrive.html","title":"OneDrive / Share","lang":"en-US","frontmatter":{"icon":"iconfont icon-state","order":36,"category":["Guide"],"tag":["Storage","Guide","302","Official"],"sticky":true,"star":true,"headerDepth":5},"headers":[{"level":2,"title":"OneDrive mount","slug":"onedrive-mount","link":"#onedrive-mount","children":[{"level":3,"title":"Create an application","slug":"create-an-application","link":"#create-an-application","children":[]},{"level":3,"title":"Get refresh token","slug":"get-refresh-token","link":"#get-refresh-token","children":[]},{"level":3,"title":"Get Sharepoint site_id","slug":"get-sharepoint-site-id","link":"#get-sharepoint-site-id","children":[]},{"level":3,"title":"Add storage","slug":"add-storage","link":"#add-storage","children":[]},{"level":3,"title":"Root folder path","slug":"root-folder-path","link":"#root-folder-path","children":[{"level":4,"title":"The default download method used","slug":"the-default-download-method-used","link":"#the-default-download-method-used","children":[]}]}]},{"level":2,"title":"Onedrive Share Url","slug":"onedrive-share-url","link":"#onedrive-share-url","children":[{"level":3,"title":"Url","slug":"url","link":"#url","children":[]},{"level":3,"title":"Password","slug":"password","link":"#password","children":[{"level":4,"title":"The default download method used","slug":"the-default-download-method-used-1","link":"#the-default-download-method-used-1","children":[]}]}]}],"git":{"createdTime":1662556125000,"updatedTime":1749643881000,"contributors":[{"name":"Noah Hsu","username":"Noah Hsu","email":"i@nn.ci","commits":1,"url":"https://github.com/Noah Hsu"},{"name":"Andy Hsu","username":"Andy Hsu","email":"i@nn.ci","commits":2,"url":"https://github.com/Andy Hsu"},{"name":"安稳","username":"安稳","email":"56105412+anwen-anyi@users.noreply.github.com","commits":4,"url":"https://github.com/安稳"},{"name":"安稳","username":"安稳","email":"anwen_anyi@foxmail.com","commits":2,"url":"https://github.com/安稳"},{"name":"anwen","username":"anwen","email":"anwen_anyi@foxmail.com","commits":1,"url":"https://github.com/anwen"},{"name":"Hantong Chen","username":"Hantong Chen","email":"cxwdyx620@gmail.com","commits":1,"url":"https://github.com/Hantong Chen"}]},"readingTime":{"minutes":2.18,"words":654},"filePathRelative":"guide/drivers/onedrive.md","localizedDate":"September 7, 2022"}');export{A as comp,x as data};
