import{d as T,r as s,j as S,f as n,m as h,Q as g,a as d,e as i,w as b,t as f,R as v,l as k,g as m,o as _}from"./app-Bl4GcpgC.js";import{_ as P}from"./aliyundrive-CF7jp5n4.js";const R={class:"hint-container warning"},A=["disabled"],K={style:{margin:"4px"}},N=["src"],q={class:"hint-container info"},W={class:"hint-container-title"},J=T({__name:"aliyundrive.html",setup(D){const a=s("获取 Token"),t=s(0),l=s(""),r=s(""),p=s(""),y=async()=>{a.value="等待...",t.value=1;const e=await(await fetch(`${m()}/alist/ali/qr`)).json();console.log(e),a.value="使用阿里云盘 APP 扫描然后点击",t.value=2,p.value=JSON.stringify({ck:e.content.data.ck,t:e.content.data.t.toString()}),l.value=`${m()}/qr/?size=400&text=${encodeURIComponent(e.content.data.codeContent)}`},x=async()=>{t.value=3,a.value="等待...";const e=await(await fetch(`${m()}/alist/ali/ck`,{method:"POST",headers:{"Content-Type":"application/json"},body:p.value})).json(),{content:{data:{qrCodeStatus:o,loginResult:u,bizExt:C}}}=e;if(u!=="success"){t.value=2,a.value="使用阿里云盘 App 扫描然后点击",alert("Status:"+o);return}const z=JSON.parse(atob(C));r.value=z.pds_login_result.refreshToken,a.value="获取 Token 成功",t.value=4,console.log(e)},w=async()=>{t.value===0&&y(),t.value===2&&x()};return(c,e)=>{const o=k("RouteLink"),u=k("Mermaid");return _(),S("div",null,[e[9]||(e[9]=n("h1",{id:"阿里云盘-分享",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#阿里云盘-分享"},[n("span",null,"阿里云盘 / 分享")])],-1)),n("div",R,[e[3]||(e[3]=n("p",{class:"hint-container-title"},"注意",-1)),n("p",null,[e[1]||(e[1]=i("不推荐使用该驱动，因为它不稳定，随时可能被屏蔽，我们会在以后的版本中移除。推荐使用官方 API 的驱动 ")),d(o,{to:"/zh/guide/drivers/aliyundrive_open.html"},{default:b(()=>e[0]||(e[0]=[i("Aliyundrive Open")])),_:1,__:[0]}),e[2]||(e[2]=i("。"))])]),e[10]||(e[10]=h('<div class="hint-container tip"><p class="hint-container-title">提示</p><p>由于阿里云盘 referer 的限制，必须使用移动端 token。 使用桌面 Web 令牌将导致无法下载和预览。<br> 当然，如果你在本地使用或者带宽足够大，你也可以开启代理，让桌面 Web 的 <code>refresh token</code> 正常工作。</p></div><h3 id="刷新令牌" tabindex="-1"><a class="header-anchor" href="#刷新令牌"><span><strong>刷新令牌</strong></span></a></h3><p>按照这个 <a href="https://github.com/Xhofe/alist/issues/88" target="_blank" rel="noopener noreferrer">issue</a> 在手机上捕获/查找日志（<code>/data/media/0/Android/data/com.alicloud.databox/files/logs/trace/</code>）。 或者您可以点击：</p>',3)),n("p",null,[n("button",{disabled:t.value===3||t.value===1,style:{outline:"none",padding:"12px",background:"#70c6be",border:"none","border-radius":"8px",cursor:"pointer","font-size":"20px"},onClick:w},[e[4]||(e[4]=n("br",null,null,-1)),i(" "+f(a.value),1),e[5]||(e[5]=n("br",null,null,-1))],8,A)]),g(n("div",K,[n("img",{src:l.value},null,8,N)],512),[[v,l.value]]),g(n("div",null,[n("div",q,[n("p",W,"Token: "+f(r.value),1)])],512),[[v,r.value]]),e[11]||(e[11]=h('<p><em>API is hosted on <a href="http://replit.com" target="_blank" rel="noopener noreferrer">replit.com</a></em></p><h3 id="根文件夹id" tabindex="-1"><a class="header-anchor" href="#根文件夹id"><span><strong>根文件夹ID</strong></span></a></h3><p>打开阿里云盘官网，点击进入要设置的文件夹时点击 URL 后面的字符串</p><p>如 <a href="https://www.alipan.com/drive/folder/5fe01e1830601baf774e4827a9fb8fb2b5bf7940" target="_blank" rel="noopener noreferrer">https://www.alipan.com/drive/folder/5fe01e1830601baf774e4827a9fb8fb2b5bf7940</a></p><p>这个文件夹的 file_id 即为 <code>5fe01e1830601baf774e4827a9fb8fb2b5bf7940</code>：</p><p><img src="'+P+'" alt="file_id" loading="lazy"></p><h3 id="秒传" tabindex="-1"><a class="header-anchor" href="#秒传"><span><strong>秒传</strong></span></a></h3><p>上传的时候校验 hash，如果云端有，直接生成文件，不消耗流量</p><h3 id="内部上传" tabindex="-1"><a class="header-anchor" href="#内部上传"><span><strong>内部上传</strong></span></a></h3><p>如果你部署 Alist 的服务器是阿里云北京地区 ECS，打开此开关可以提升文件上传速度。不符合要求的服务器请不要打开此开关，否则会出现无法上传的问题。</p><br><h2 id="阿里云盘分享" tabindex="-1"><a class="header-anchor" href="#阿里云盘分享"><span><strong>阿里云盘分享</strong></span></a></h2>',12)),n("p",null,[e[7]||(e[7]=i("已经无法使用，并且后续不再开发和维护分享存储方式，同时")),d(o,{to:"/zh/guide/drivers/aliyundrive_open.html"},{default:b(()=>e[6]||(e[6]=[n("strong",null,"阿里云盘Open",-1)])),_:1,__:[6]}),e[8]||(e[8]=i("获取的Token也不可以在阿里云盘分享挂载存储使用。"))]),e[12]||(e[12]=n("br",null,null,-1)),e[13]||(e[13]=n("h3",{id:"默认使用的下载方式",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#默认使用的下载方式"},[n("span",null,[n("strong",null,"默认使用的下载方式")])])],-1)),d(u,{id:"mermaid-69",code:"eJzT1dXlKsksyUm1Uni5e8aLdUue7N3/fMqK57Nank5e9Xx575Md3S/27n02befTPf3v98znAqlPy8kvT85ILCpRCHHiUgCC4pLKnFSFREOFtMycHCvlpKQ0neKSovzsVCvlNDMzKFu3PDOlJMPKqKBCJzk/J78IKJeWhqzdCKo9Lc3c1NwUboKxsTGqCSYFFRBtpUnpRYkFGQqZKamGCtEKsWDRREMwlZqXAuVGGxsYxVpZWRXn56Ym5yQWF9sCQQ3EszWJRtFA3z7r2P5i3b6nS9ohRoBVuaSmKcC1wFxmaQZRYBj9bM6aZ3N2Pdm9+PmEtlhdPaDelw2derp2WA1MMoyGqAwN8iGoODknMzkbFJhKenr6KUWZZalFxfrJ+bm5+Xl6GSW5OcrlqUkpiWW6z9dOez51qRKSniQy9CQTrQcAkHnb9A=="})])}}}),O=JSON.parse('{"path":"/zh/guide/drivers/aliyundrive.html","title":"阿里云盘 / 分享","lang":"zh-CN","frontmatter":{"icon":"iconfont icon-state","order":16,"category":["Guide"],"tag":["Storage","Guide","302"],"sticky":true,"star":true},"headers":[{"level":3,"title":"刷新令牌","slug":"刷新令牌","link":"#刷新令牌","children":[]},{"level":3,"title":"根文件夹ID","slug":"根文件夹id","link":"#根文件夹id","children":[]},{"level":3,"title":"秒传","slug":"秒传","link":"#秒传","children":[]},{"level":3,"title":"内部上传","slug":"内部上传","link":"#内部上传","children":[]},{"level":2,"title":"阿里云盘分享","slug":"阿里云盘分享","link":"#阿里云盘分享","children":[{"level":3,"title":"默认使用的下载方式","slug":"默认使用的下载方式","link":"#默认使用的下载方式","children":[]}]}],"git":{"createdTime":1662556125000,"updatedTime":1745426363000,"contributors":[{"name":"Noah Hsu","username":"Noah Hsu","email":"i@nn.ci","commits":8,"url":"https://github.com/Noah Hsu"},{"name":"Chi_Tang","username":"Chi_Tang","email":"chitang@duck.com","commits":1,"url":"https://github.com/Chi_Tang"},{"name":"sheltonzhu","username":"sheltonzhu","email":"498220739@qq.com","commits":1,"url":"https://github.com/sheltonzhu"},{"name":"孟古一","username":"孟古一","email":"73788063+mengguyi@users.noreply.github.com","commits":1,"url":"https://github.com/孟古一"},{"name":"安稳","username":"安稳","email":"56105412+anwen-anyi@users.noreply.github.com","commits":7,"url":"https://github.com/安稳"},{"name":"Wuxuan","username":"Wuxuan","email":"git@wangwuxuan.cn","commits":1,"url":"https://github.com/Wuxuan"},{"name":"Andy Hsu","username":"Andy Hsu","email":"i@nn.ci","commits":4,"url":"https://github.com/Andy Hsu"},{"name":"Patrick-Ze","username":"Patrick-Ze","email":"19711799+Patrick-Ze@users.noreply.github.com","commits":1,"url":"https://github.com/Patrick-Ze"},{"name":"安稳","username":"安稳","email":"anwen_anyi@foxmail.com","commits":5,"url":"https://github.com/安稳"},{"name":"anwen","username":"anwen","email":"anwen_anyi@foxmail.com","commits":1,"url":"https://github.com/anwen"}]},"readingTime":{"minutes":2.52,"words":756},"filePathRelative":"zh/guide/drivers/aliyundrive.md","localizedDate":"2022年9月7日"}');export{J as comp,O as data};
